package cleartrip.flightbooking.po;

import java.sql.Date;
import java.sql.Time;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;

import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.FindBy;
import org.openqa.selenium.support.How;
import org.testng.Reporter;

import okio.Timeout;

public class Bookticketpage {
	
	WebDriver driver;
	
	public Bookticketpage(WebDriver driver)
	{
		this.driver=driver;
	}
	
	
	@FindBy(how = How.XPATH,using = "//p[text()=\"Round trip\"]")
	WebElement roundtrip_rbt;
	
	@FindBy(how = How.XPATH,using = "//h4[text()=\"From\"]/../div/descendant::input")
	WebElement From_txt;
	
	@FindBy(how = How.XPATH,using = "//h4[text()=\"To\"]/../div/descendant::input")
	WebElement To_txt;
	
	@FindBy(how = How.XPATH,using = "//div[@class=\"p-relative\"]/descendant::li/p")
	WebElement suggoption;
	
	
	@FindBy(how = How.XPATH,using = "//h4[text()=\"Depart on\"]/../../following-sibling::div/descendant::button/div")
	WebElement Departdate;
	
	
	
	
	
	//@FindBy(how = How.XPATH,using = "//div[@class=\"DayPicker-Caption\"]/div[contains(.,"+"July"+")]/../../descendant::div[@class=\"Day-grid flex flex-middle flex-column flex-center\"]/div[text()="+"24"+"]")
	//WebElement Departdateoption ;
	
	
	
	
	
	
	
	


	public void Booktickectroundtrip(String From,String To) throws InterruptedException {
		roundtrip_rbt.click();
		From_txt.sendKeys(From);
		Thread.sleep(500);
		String From_option=suggoption.getText();
		
		if (From_option.contains(From))
		{
			System.out.println("click");
			suggoption.click();
		}
		else
		{
			suggoption.click();
			Reporter.log("No Such kind of From Location in our journet list please provird valid option");
		}
		
		To_txt.sendKeys(To);
		Thread.sleep(500);
		String To_option=suggoption.getText();
		if (To_option.contains(To))
		{
			System.out.println("click");
			suggoption.click();
		}
		else
		{
			System.out.println("notclick");
			Reporter.log("No Such kind of TO Location in our journet list please provird valid option");
		}
		
		
		
		Departdate.click();
		
		
		/*
		 * String Displayingdate=Departdate.getText(); String[]
		 * split1=Displayingdate.split(" "); String Todaydate=split1[2];
		 * System.out.println(Todaydate); int Depaturedate=Integer.parseInt(Todaydate);
		 * Depaturedate=Depaturedate+2;
		 */
		
		java.util.Date date=java.util.Calendar.getInstance().getTime();  
		System.out.println(date); 
		
		LocalDate xx=java.time.LocalDate.now();
		String yy=xx.toString();
		LocalDate date1 = LocalDate.parse(yy);
		//add 2 days
		LocalDate date2 = date1.plusDays(2);;
		DateTimeFormatter formatter = DateTimeFormatter.ofPattern("dd LLLL yyyy");
		String formattedString = date2.format(formatter);
		System.out.println(formattedString);
		String[] split1=formattedString.split(" ");
		
		
		
		String Month=split1[1];
		String Date=split1[0];
		
		System.out.println("//div[@class='DayPicker-Caption']/div[contains(.,"+"'"+Month+"'"+")]/../../descendant::div[contains(@class,'Day-grid flex')]/div[text()="+"'"+Date+"'"+"]/../..");
		Thread.sleep(5000);
		
		
		Actions Act = new Actions(driver);
		
		Act.sendKeys(Keys.PAGE_DOWN);
		Act.perform();
		Thread.sleep(5000);
		
		WebElement Departdateoption=driver.findElement(By.xpath("//div[@class='DayPicker-Caption']/div[contains(.,"+"'"+Month+"'"+")]/../../descendant::div[contains(@class,'Day-grid flex')]/div[text()="+"'"+Date+"'"+"]/../.."));
		Departdateoption.click();
		Act.moveToElement(Departdateoption).click().perform();
		
		
		
		
		
		
				
		
	}









	

}
